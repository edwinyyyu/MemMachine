{
  "openapi": "3.1.0",
  "info": {
    "title": "MemMachine API",
    "version": "2.0.0",
    "description": "Architectural Memory Systems for AI Agents. Specialized in episodic and semantic memory management with strict namespace isolation."
  },
  "servers": [
    {
      "url": "http://localhost:8080"
    }
  ],
  "tags": [
    {
      "name": "Projects",
      "description": "Lifecycle management for isolated memory namespaces."
    },
    {
      "name": "Memories",
      "description": "Core operations for episodic and semantic memory ingestion and retrieval."
    },
    {
      "name": "System",
      "description": "Infrastructure, health, and observability."
    }
  ],
  "paths": {
    "/api/v2/projects": {
      "post": {
        "tags": ["Projects"],
        "summary": "Create Project",
        "description": "Create a new project under a specified organization. Each project acts as an isolated memory namespace; no cross-project memory access is allowed.",
        "operationId": "create_project_api_v2_projects_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateProjectSpec" } } },
          "required": true
        },
        "responses": {
          "201": { "description": "Successful Response", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProjectResponse" } } } },
          "422": { "description": "Validation Error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } } }
        }
      }
    },
    "/api/v2/projects/get": {
      "post": {
        "tags": ["Projects"],
        "summary": "Get Project",
        "description": "Retrieve the project identified by `org_id` and `project_id`. Includes the project's description and effective configuration.",
        "operationId": "get_project_api_v2_projects_get_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/GetProjectSpec" } } },
          "required": true
        },
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ProjectResponse" } } } },
          "422": { "description": "Validation Error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } } }
        }
      }
    },
    "/api/v2/projects/episode_count/get": {
      "post": {
        "tags": ["Projects"],
        "summary": "Get Episode Count",
        "description": "Retrieve the total number of episodes (minimal unit of memory) currently recorded for the specified project.",
        "operationId": "get_episode_count_api_v2_projects_episode_count_get_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/GetProjectSpec" } } },
          "required": true
        },
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/EpisodeCountResponse" } } } }
        }
      }
    },
    "/api/v2/projects/list": {
      "post": {
        "tags": ["Projects"],
        "summary": "List Projects",
        "description": "Returns a list of all projects accessible within the system.",
        "operationId": "list_projects_api_v2_projects_list_post",
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "type": "array", "items": { "type": "object", "additionalProperties": { "type": "string" } } } } } }
        }
      }
    },
    "/api/v2/projects/delete": {
      "post": {
        "tags": ["Projects"],
        "summary": "Delete Project",
        "description": "Permanently removes a project and all associated memories. This action cannot be undone.",
        "operationId": "delete_project_api_v2_projects_delete_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DeleteProjectSpec" } } },
          "required": true
        },
        "responses": {
          "204": { "description": "Successful Response" }
        }
      }
    },
    "/api/v2/memories": {
      "post": {
        "tags": ["Memories"],
        "summary": "Add Memories",
        "description": "Add memory messages (batch) to Episodic, Semantic, or both memory types.",
        "operationId": "add_memories_api_v2_memories_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AddMemoriesSpec" } } },
          "required": true
        },
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AddMemoriesResponse" } } } }
        }
      }
    },
    "/api/v2/memories/search": {
      "post": {
        "tags": ["Memories"],
        "summary": "Search Memories",
        "description": "Vector search with metadata filtering. Returns top K relevant memories sorted by relevance/timestamp.",
        "operationId": "search_memories_api_v2_memories_search_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchMemoriesSpec" } } },
          "required": true
        },
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchResult" } } } }
        }
      }
    },
    "/api/v2/memories/list": {
      "post": {
        "tags": ["Memories"],
        "summary": "List Memories",
        "description": "Paginated retrieval of memories stored in the project with optional metadata filtering.",
        "operationId": "list_memories_api_v2_memories_list_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListMemoriesSpec" } } },
          "required": true
        },
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/SearchResult" } } } }
        }
      }
    },
    "/api/v2/memories/episodic/delete": {
      "post": {
        "tags": ["Memories"],
        "summary": "Delete Episodic Memory",
        "operationId": "delete_episodic_memory_api_v2_memories_episodic_delete_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DeleteEpisodicMemorySpec" } } },
          "required": true
        },
        "responses": { "204": { "description": "Successful Response" } }
      }
    },
    "/api/v2/memories/semantic/delete": {
      "post": {
        "tags": ["Memories"],
        "summary": "Delete Semantic Memory",
        "operationId": "delete_semantic_memory_api_v2_memories_semantic_delete_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DeleteSemanticMemorySpec" } } },
          "required": true
        },
        "responses": { "204": { "description": "Successful Response" } }
      }
    },
    "/api/v2/metrics": {
      "get": {
        "tags": ["System"],
        "summary": "Metrics",
        "operationId": "metrics_api_v2_metrics_get",
        "responses": { "200": { "description": "Successful Response" } }
      }
    },
    "/api/v2/health": {
      "get": {
        "tags": ["System"],
        "summary": "Health Check",
        "operationId": "health_check_api_v2_health_get",
        "responses": {
          "200": { "description": "Successful Response", "content": { "application/json": { "schema": { "type": "object", "additionalProperties": { "type": "string" } } } } }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AddMemoriesResponse": {
        "type": "object",
        "required": ["results"],
        "properties": {
          "results": { "type": "array", "items": { "$ref": "#/components/schemas/AddMemoryResult" } }
        },
        "description": "Response model for adding memories."
      },
      "AddMemoriesSpec": {
        "type": "object",
        "required": ["messages"],
        "properties": {
          "org_id": { "type": "string", "default": "universal" },
          "project_id": { "type": "string", "default": "universal" },
          "types": { "type": "array", "items": { "$ref": "#/components/schemas/MemoryType" } },
          "messages": { "type": "array", "minItems": 1, "items": { "$ref": "#/components/schemas/MemoryMessage" } }
        },
        "description": "Specification model for adding memories."
      },
      "AddMemoryResult": {
        "type": "object",
        "required": ["uid"],
        "properties": { "uid": { "type": "string" } }
      },
      "CreateProjectSpec": {
        "type": "object",
        "required": ["org_id", "project_id"],
        "properties": {
          "org_id": { "type": "string" },
          "project_id": { "type": "string" },
          "description": { "type": "string", "default": "" },
          "config": { "$ref": "#/components/schemas/ProjectConfig" }
        }
      },
      "DeleteEpisodicMemorySpec": {
        "type": "object",
        "properties": {
          "org_id": { "type": "string", "default": "universal" },
          "project_id": { "type": "string", "default": "universal" },
          "episodic_id": { "type": "string", "default": "" },
          "episodic_ids": { "type": "array", "items": { "type": "string" }, "default": [] }
        }
      },
      "DeleteProjectSpec": {
        "type": "object",
        "required": ["org_id", "project_id"],
        "properties": { "org_id": { "type": "string" }, "project_id": { "type": "string" } }
      },
      "DeleteSemanticMemorySpec": {
        "type": "object",
        "properties": {
          "org_id": { "type": "string", "default": "universal" },
          "project_id": { "type": "string", "default": "universal" },
          "semantic_id": { "type": "string", "default": "" },
          "semantic_ids": { "type": "array", "items": { "type": "string" }, "default": [] }
        }
      },
      "EpisodeCountResponse": {
        "type": "object",
        "required": ["count"],
        "properties": { "count": { "type": "integer", "minimum": 0 } }
      },
      "GetProjectSpec": {
        "type": "object",
        "required": ["org_id", "project_id"],
        "properties": { "org_id": { "type": "string" }, "project_id": { "type": "string" } }
      },
      "HTTPValidationError": {
        "type": "object",
        "properties": { "detail": { "type": "array", "items": { "$ref": "#/components/schemas/ValidationError" } } }
      },
      "ListMemoriesSpec": {
        "type": "object",
        "properties": {
          "org_id": { "type": "string", "default": "universal" },
          "project_id": { "type": "string", "default": "universal" },
          "page_size": { "type": "integer", "default": 100 },
          "page_num": { "type": "integer", "default": 0 },
          "filter": { "type": "string", "default": "" },
          "type": { "$ref": "#/components/schemas/MemoryType", "default": "episodic" }
        }
      },
      "MemoryMessage": {
        "type": "object",
        "required": ["content"],
        "properties": {
          "content": { "type": "string" },
          "producer": { "type": "string", "default": "user" },
          "produced_for": { "type": "string", "default": "" },
          "timestamp": { "type": "string", "format": "date-time" },
          "role": { "type": "string", "default": "" },
          "metadata": { "type": "object", "additionalProperties": { "type": "string" } }
        }
      },
      "MemoryType": { "type": "string", "enum": ["semantic", "episodic"] },
      "ProjectConfig": {
        "type": "object",
        "properties": {
          "reranker": { "type": "string", "default": "" },
          "embedder": { "type": "string", "default": "" }
        }
      },
      "ProjectResponse": {
        "type": "object",
        "required": ["org_id", "project_id"],
        "properties": {
          "org_id": { "type": "string" },
          "project_id": { "type": "string" },
          "description": { "type": "string", "default": "" },
          "config": { "$ref": "#/components/schemas/ProjectConfig" }
        }
      },
      "SearchMemoriesSpec": {
        "type": "object",
        "required": ["query"],
        "properties": {
          "org_id": { "type": "string", "default": "universal" },
          "project_id": { "type": "string", "default": "universal" },
          "top_k": { "type": "integer", "default": 10 },
          "query": { "type": "string" },
          "filter": { "type": "string", "default": "" },
          "types": { "type": "array", "items": { "$ref": "#/components/schemas/MemoryType" } }
        }
      },
      "SearchResult": {
        "type": "object",
        "required": ["content"],
        "properties": {
          "status": { "type": "integer", "default": 0 },
          "content": { "type": "object", "additionalProperties": true }
        }
      },
      "ValidationError": {
        "type": "object",
        "required": ["loc", "msg", "type"],
        "properties": {
          "loc": { "type": "array", "items": { "anyOf": [{ "type": "string" }, { "type": "integer" }] } },
          "msg": { "type": "string" },
          "type": { "type": "string" }
        }
      }
    }
  }
}